---
title: "HW9-TA"
output: html_document
---

```{r setup, include=FALSE, echo = FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      warning = FALSE)
```


```{r, include=FALSE,echo=FALSE}
library(tidyverse)
library(MASS)
```

# Question 1. 
The Zoology department of The University of Adelaide was curious to see if Native snails and Exotic snails had the same ability to survive in different conditions. The two different species of snail were exposed to different relative humidities and temperatures for 1, 2, 3, or 4 weeks. The snail data is included in the package `MASS`. 

## A. 
 Plot a boxplot for each relative humitidy (one new plot for 60%, 65.8%, 70.5%, and 75.8% relative humidity). The x axis of the boxplot should be Temperature, the y axis should the the number of deaths, and the boxplots should be filled with the species type. 
```{r boxplot, echo = FALSE}
ggplot(snails, aes(x = as.factor(Temp), y = Deaths, fill = Species)) +
  geom_boxplot() +
  xlab("Temperature") +
  ggsci::scale_fill_locuszoom() +
  facet_wrap("Rel.Hum") +
  theme_bw()
```

## B. 
Use the appropriate statistical test to investigate whether Species A survives better than Species B in 60% Relative Humidity regardless of temperature. If you take temperature into account, does your conclusion change? 

Please report your answer by filling in the blanks below. 

* Null Hypothesis: 

* Test used and reason:

* P-value:

* Reject null? (Y/N) and why:


# Question 2. 
Now we will use the thyroid data. We want to know whether patients treated with different doses of the drug sorafenib respond differently. Split the patients into high treatment and low treatment at your discretion. Keep in mind that a more even split in the number of patients in each group is better. 

## A. 
Plot a boxplot of tumor response in the two patient groups. The x axis should be patient groups, the y axis should be tumor response.


## B. 
Use the appropriate statistical test to investigate whether tumor response is different between the two groups.

Please report your answer by filling in the blanks below. 

* Null Hypothesis: 

* Test used and reason:

* P-value:

* Reject null? (Y/N) and why:

# Question 3. 
Now we will use the Mauna Loa C02 concentrations dataset. We will predict the response of the Temperature based on Wind.

A reminder: 

### Residual 
Deviation of the observed value to the estimated value (sample mean)
$$residual=y_i - \hat{y_i}$$
where $\hat{y_i}$ is the estimated value

### Here are some assumptions that linear regression makes: 
* The residuals should be close to zero.
* There should be equal variance around the regression line (homoscedasticity).
* Residuals should be normally distributed.
* Independent variables and residuals should not be correlated.

```{r}
data(airquality)
```


This is the data we will fit a linear model to. 
```{r, echo = FALSE}
ggplot(data = airquality) +
  geom_point(aes(x=Wind, y=Temp)) +
  theme_bw()
```

## A.
Create and fit a linear model to predict Temperature from Wind.

```{r, include = F}
#linear_regression <- lm(Temp ~ Wind, data = airquality)
```


## B.
Vizualize how your model performed on the data by plotting the regression line on top of the data points. 


## C. 
Look at the residuals. Are they close to zero? 
```{r}
#look at the median residual value. Close to zero is best
#help(summary)
```


## D. 
Plot predicted temperature vs observed temperature. A strong model should show a strong correlation


## E. 
Plot Wind vs predicted Temperature, and on the same plot, add Wind vs measured Temperature, and the regression line.
```{r, include = FALSE}
# Extract coefficients from the model
# plot the regression line on the predicted values
# plot the original test values
```

## F. 
Residuals should be normally distributed. Plot the density of the residuals. Are they normally distributed? (help(residuals))
```{r, include= FALSE}
#residuals_lin <- residuals(linear_regression)
#ggplot(data=residvpredict) +
#  geom_density(aes(residual))
```

## G.
Independent variables and residuals should not be correlated. Calculate the correlation between the Wind and the residuals. 
```{r, include = FALSE}
#cor.test(train_regression$Wind, resid(linear_regression))
```

